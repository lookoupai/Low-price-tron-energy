### 项目名称
查找低价TRON能量地址脚本

### 项目描述
开发一个自动化脚本，用于查找和验证低价TRON能量地址。该脚本将通过调用TronGrid API或Tronscan API，实现以下功能流程，替代手动在浏览器中执行的步骤。最终输出应符合指定的格式，便于用户快速识别和使用低价能量地址。

### 技术要求
- **编程语言**：建议使用Python，但不限于此，可根据开发者熟悉的语言选择。
- **API**：使用[TronGrid API](https://www.trongrid.io/)或[Tronscan API](https://tronscan.org/#/)进行数据获取。
- **依赖库**：根据选择的编程语言，可能需要使用HTTP请求库（如Python的`requests`）、JSON解析库等。

### 功能流程

1. **获取最新区块**
    - 调用API获取最新区块号。
    - 示例API端点（根据选择的API可能有所不同）：
      - TronGrid: `https://api.trongrid.io/wallet/getnowblock`
      - Tronscan: `https://apilist.tronscan.org/api/block?sort=-number&limit=1`

2. **获取区块详情**
    - 使用最新区块号获取区块的详细信息。
    - 示例API端点：
      - TronGrid: `https://api.trongrid.io/wallet/getblockbynum?num={block_number}`
      - Tronscan: `https://apilist.tronscan.org/api/block/{block_number}`

3. **筛选“代理资源”交易**
    - 从区块的交易列表中筛选出所有交易类型为“代理资源”的交易。

4. **获取“接收人”钱包地址详情**
    - 对每笔“代理资源”交易，提取“接收人”钱包地址。
    - 调用API获取该地址的资源详情。
    - 示例API端点：
      - TronGrid: `https://api.trongrid.io/v1/accounts/{address}`
      - Tronscan: `https://apilist.tronscan.org/api/account?address={address}`

5. **检查钱包地址的最近20条交易**
    - 获取“接收人”地址的最近20条交易记录。
    - 筛选出交易类型为“TRX转账”、通证为“TRX”、数量在0.1-1 TRX之间的交易。

6. **验证交易记录顺序**
    - 对于筛选出的每笔“TRX转账”交易，检查其下一条交易记录是否为“代理资源”类型。
    - 如果符合，则将该“接收人”地址标记为潜在的低价TRON能量地址。

7. **进一步验证低价TRON能量地址**
    - 对于确定的低价TRON能量地址，获取其最近10次交易。
    - 检查是否有“TRX转账”交易，通证为“TRX”，数量在0.1-1 TRX之间，并且至少5次TRX数量相同。
    - 如果满足，则确认该地址为低价TRON能量地址。

8. **统计“代理资源”地址数量**
    - 查看确认的低价TRON能量地址的最近10次交易中的“发送人”地址。
    - 对每个“发送人”地址，重复步骤4-6，统计获得的“代理资源”地址数量。

9. **判断地址状态**
    - 根据统计结果，确定地址的状态：
        - **正常使用**：统计获得的“代理资源”地址数量大于7。
        - **少于100U不给能量**：数量小于7。
        - **异常**：数量小于5。

10. **记录能量数量**
    - 在重复步骤4-6的过程中，查看“交易类型”为“代理资源”的交易记录，记录每笔交易的“能量数量”。
    - 例如：“账户 TD7Tsy7ZU4BMBaQMYXDAvZi8zso8SRxTky 代理 64,998.86 能量给 TRRzeNM2R8S8AxHoUZzzFdV1J9DSwWVhMU”，记录“能量数量”为“64,998.86 能量”。

11. **记录购买金额**
    - 对于每个低价TRON能量地址，分析其最新10次交易，记录购买金额。
    - 确认购买金额：在最新10次交易中，有大于5次相同金额的TRX转账，记录该金额作为“购买金额”。
    - 例如，如果一个地址的最新10次交易中，有6次转账为1.0 TRX，则“购买金额”为1.0 TRX。

12. **判断地址状态**
    - 根据统计获得的“代理资源”地址数量，确定地址的状态：
        - **正常使用**：统计获得的“代理资源”地址数量大于7。
        - **少于100U不给能量**：数量小于7。
        - **异常**：数量小于5。

13. **输出结果**
    - 仅输出状态为“正常使用”或“少于100U不给能量”的低价TRON能量地址。
    - 每个输出地址应包含以下信息，并附带参考信息：

      ```
      🎉 找到实时能量地址
      🕵️‍♂️ 每次都是当前最新的区块分析，无需担心能量地址失效！

      🔹 【能量地址】: TEXwQ99D4nLj14uK9GtXhwGXSYFzmKtUoV
      🔹 【购买记录】：https://tronscan.org/#/address/TEXwQ99D4nLj14uK9GtXhwGXSYFzmKtUoV
      🔹 【购买金额】: 1.0 TRX
      🔹 【能量数量】: 65002.35 能量

      【地址信息】最近10个交易中，获得能量大于7个，状态正常，但是不保证一定可以获得能量
      ```

      或

      ```
      🎉 找到实时能量地址
      🕵️‍♂️ 每次都是当前最新的区块分析，无需担心能量地址失效！

      🔹 【能量地址】: TYGT2nLqT35Er9bdu9NTCjbWBMTSwKiAYE
      🔹 【购买记录】：https://tronscan.org/#/address/TYGT2nLqT35Er9bdu9NTCjbWBMTSwKiAYE
      🔹 【购买金额】: 0.8 TRX
      🔹 【能量数量】: 45000.50 能量

      【地址信息】最近10个交易中，获得能量少于7个，可能钱包少于100U不给能量
      ```

    - **字段说明**：
        - **能量地址**：确认的低价TRON能量地址。
        - **购买记录**：链接至该地址的交易详情页面。
        - **购买金额**：TRX的购买金额，基于最新10次交易中大于5次相同金额的TRX转账，范围在0.1-1 TRX之间。
        - **能量数量**：该地址拥有的TRON能量数量。
        - **参考信息**：根据统计结果提供的状态说明。

    - **输出格式**：可选择输出为文本文件、JSON、Markdown等格式，确保信息清晰易读。

### 开发步骤建议

1. **环境搭建**
    - 选择编程语言并设置开发环境。
    - 安装必要的依赖库。

2. **API集成**
    - 根据选择的API（TronGrid或Tronscan），实现基本的API调用功能。
    - 测试API连接和数据获取是否正常。

3. **功能模块开发**
    - 按照功能流程逐步实现各个模块，例如获取区块信息、筛选交易、验证交易顺序等。
    - 每个模块开发完成后进行单元测试，确保其功能正确。

4. **逻辑实现**
    - 实现复杂的逻辑判断，如交易记录顺序验证、统计“代理资源”地址数量等。
    - 在步骤10中实现能量数量的记录。
    - 在步骤11中实现购买金额的记录。
    - 确保逻辑的准确性和效率。

5. **结果输出**
    - 设计并实现结果的存储和输出方式，确保数据易于读取和分析。
    - 按照指定的输出格式生成结果。

6. **优化与错误处理**
    - 添加错误处理机制，处理API调用失败、数据异常等情况。
    - 优化脚本性能，确保在处理大量数据时的效率。

7. **测试与验证**
    - 在多个区块和地址上进行测试，验证脚本的准确性和稳定性。
    - 根据测试结果进行必要的调整和优化。

### 注意事项
- **API限额**：了解所选API的调用频率限制，避免超过限额导致调用失败。
- **数据一致性**：确保获取的数据最新且准确，处理可能的延迟或数据不一致问题。
- **安全性**：妥善处理API密钥（如有），避免泄露敏感信息。
- **可扩展性**：设计脚本结构时考虑未来可能的功能扩展需求。

### 参考资源
- [TronGrid API 文档](https://www.trongrid.io/docs)
- [Tronscan API 文档](https://tronscan.org/#/api-docs)
- [TRON开发者中心](https://developers.tron.network/)
